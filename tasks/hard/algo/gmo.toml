level             = "hard"
name              = "gmo"
tags              = ["algo", "strings", "dp", "greedy"]
time_to_solve_sec = 600

description_en = """
A gene is a string $S$ ($|S| \\leq 20$) over $\\{A,C,G,T\\}$. You may **insert** any letters anywhere.
Insertion costs: $\\text{cost}(A)=a$, $\\text{cost}(C)=c$, $\\text{cost}(G)=g$, $\\text{cost}(T)=t$.

Find the minimum total cost of insertions to make $S$ contain $P$ ($|P| \\leq 20$) as a **substring**.
"""

description_ru = """
Ген представлен строкой $S$ ($|S| \\leq 20$) над алфавитом $\\{A,C,G,T\\}$. Разрешены только **вставки** символов.
Стоимость вставки: $\\text{cost}(A)=a$, $\\text{cost}(C)=c$, $\\text{cost}(G)=g$, $\\text{cost}(T)=t$.

Найдите минимальную суммарную стоимость вставок, чтобы строка $S$ содержала $P$ ($|P| \\leq 20$) как **подстроку**.
"""

limits = """
- $0 \\leq |S| \\leq 20$
- $0 \\leq |P| \\leq 20$
- $0 \\leq a,c,g,t \\leq 100$
"""

solution = """
def solution(s: str, p: str, a: int, c: int, g: int, t: int) -> int:
    cost = {'A':a,'C':c,'G':g,'T':t}
    total_p = sum(cost[x] for x in p)
    # choose a contiguous substring T = s[i:j] that is a subsequence of p
    # saved cost = sum cost of T (since we don't need to insert those)
    # answer = total_p - max_saved
    n = len(s)
    m = len(p)
    max_saved = 0
    for i in range(n+1):
        for j in range(i, n+1):
            T = s[i:j]
            # check if T is a subsequence of p
            k = 0
            for ch in p:
                if k < len(T) and ch == T[k]:
                    k += 1
            if k == len(T):
                saved = sum(cost[ch] for ch in T)
                if saved > max_saved:
                    max_saved = saved
    return total_p - max_saved
"""

examples = """
solution("AAT", "AC", 1, 2, 3, 4) == 2
solution("AAA", "AA", 1, 1, 1, 1) == 0
solution("GTA", "CAT", 5, 7, 1, 3) == 10
"""

[[input_signature]]
argument_name = "s"
[input_signature.type]
name = "string"

[[input_signature]]
argument_name = "p"
[input_signature.type]
name = "string"

[[input_signature]]
argument_name = "a"
[input_signature.type]
name = "integer"

[[input_signature]]
argument_name = "c"
[input_signature.type]
name = "integer"

[[input_signature]]
argument_name = "g"
[input_signature.type]
name = "integer"

[[input_signature]]
argument_name = "t"
[input_signature.type]
name = "integer"

[output_signature.type]
name = "integer"


[[asserts]]
arguments = ["AAT", "AC", 1, 2, 3, 4]
expected  = 2

[[asserts]]
arguments = ["AAA", "AA", 1, 1, 1, 1]
expected  = 0

[[asserts]]
arguments = ["GTA", "CAT", 5, 7, 1, 3]
expected  = 10

[[asserts]]
arguments = ["CTTCAAAGACTGCTCATT", "CCCAAGG", 8, 6, 1, 2]
expected  = 14

[[asserts]]
arguments = ["CCTGAACGAGGG", "TTATGTTCGCGT", 10, 6, 8, 10]
expected  = 72

[[asserts]]
arguments = ["TTCTAAC", "TT", 9, 2, 9, 9]
expected  = 0

[[asserts]]
arguments = ["ACGGC", "TCCTTCTAGCTGCCAT", 7, 9, 9, 1]
expected  = 56

[[asserts]]
arguments = ["TTAAGCA", "TCTG", 10, 1, 2, 5]
expected  = 3

[[asserts]]
arguments = ["AATTCCAGTA", "CGCTTCATGCGCCCCAA", 2, 7, 7, 2]
expected  = 66

[[asserts]]
arguments = ["CG", "GAGTATGCACTCCTCTT", 4, 8, 5, 4]
expected  = 83

[[asserts]]
arguments = ["AGCTAGAAGGTCATTTAACT", "GCTTATTATAAGATCCTAC", 4, 1, 2, 9]
expected  = 45

[[asserts]]
arguments = ["CCGAACGCG", "GCAATAGCAGCTTTCTT", 9, 2, 10, 10]
expected  = 92

[[asserts]]
arguments = ["CACCGA", "GCATATATTGGTA", 5, 1, 5, 7]
expected  = 60

[[asserts]]
arguments = ["CGGTT", "ACTGCTATGGAGG", 3, 4, 1, 9]
expected  = 30

[[asserts]]
arguments = ["GCCGAGTTTAGA", "ATTAGC", 10, 8, 7, 3]
expected  = 18

[[asserts]]
arguments = ["TTCATAAAAC", "GGTGTCCGAGCCG", 1, 2, 1, 8]
expected  = 12

[[asserts]]
arguments = ["TCTCTTCCCTAT", "GAAGACCCTAATCTGC", 4, 10, 6, 5]
expected  = 59

[[asserts]]
arguments = ["CCCAATCAATCA", "TGTACTTGTACAAG", 8, 5, 6, 6]
expected  = 55

[[asserts]]
arguments = ["AG", "TAACGG", 1, 10, 7, 3]
expected  = 21

[[asserts]]
arguments = ["CTGTAAAGAGTATTGGTTC", "CGACG", 8, 4, 5, 10]
expected  = 8

[[asserts]]
arguments = ["CTTTCATAGCGAAGACTTGC", "CCCACTAAAAACCTAGTA", 1, 8, 7, 10]
expected  = 55

[[asserts]]
arguments = ["ATCCATGATATGAACC", "CCAAGCCGGCT", 5, 6, 8, 3]
expected  = 45

[[asserts]]
arguments = ["ATC", "CACGCACTTTCACCTAGT", 4, 6, 3, 7]
expected  = 82

[[asserts]]
arguments = ["TC", "ATACGAGGACCAATCCAC", 1, 4, 2, 10]
expected  = 43

[[asserts]]
arguments = ["TTATATTAC", "GACG", 10, 5, 3, 6]
expected  = 6

[[asserts]]
arguments = ["AAGT", "CCTATGGCTG", 3, 6, 9, 5]
expected  = 46

[[asserts]]
arguments = ["CTACACTCCGAAGCGGATAC", "CTTTATGCGAT", 6, 5, 4, 6]
expected  = 32

[[asserts]]
arguments = ["GCTTTGGC", "CCCTTAGGGCG", 6, 1, 3, 4]
expected  = 15

[[asserts]]
arguments = ["GCGCGTCA", "GAACTACGTTC", 3, 5, 3, 7]
expected  = 28

[[asserts]]
arguments = ["ACAGTGCTGGGTCT", "AAACAGTAAAA", 2, 10, 1, 1]
expected  = 12

[[asserts]]
arguments = ["CTTGTCCCATACC", "CTTGCGATGGGAGGCGCGCT", 4, 8, 10, 10]
expected  = 106

[[asserts]]
arguments = ["GAGTCGGCG", "TTATTCATAGAGGG", 9, 1, 3, 6]
expected  = 64
