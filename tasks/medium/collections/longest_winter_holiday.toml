level             = "medium"
name              = "longest_winter_holiday"
tags              = ["collections", "algo"]
time_to_solve_sec = 400

description_en = """
Given an array of `0` and `1`, where `1` represents a holiday. You can replace at most `k` zeros with ones.

Find the maximum length of a continuous holiday period after replacements.
"""

description_ru = """
Дан массив из `0` и `1`, где `1` — выходной день. Можно заменить не более `k` нулей на единицы.

Найдите максимальную длину непрерывного праздничного периода.
"""

limits = """
- $1 \\leq \\text{len}(\\text{days}) \\leq 10^5$
- $0 \\leq k \\leq \\text{len}(\\text{days})$
- $\\text{days}[i] \\in \\{0, 1\\}$
"""

solution = """
def solution(days: list[int], k: int) -> int:
    l = z = m = 0
    for r in range(len(days)):
        if days[r] == 0:
            z += 1
        while z > k:
            if days[l] == 0:
                z -= 1
            l += 1
        m = max(m, r - l + 1)
    return m
"""

examples = """
solution([1], 0) == 1
solution([0], 1) == 1
solution([1, 0, 1], 1) == 3
solution([1, 0, 0, 1], 1) == 3
solution([1, 1, 0, 0, 1, 1], 2) == 6
"""

[[input_signature]]
argument_name = "days"
[input_signature.type]
name = "array"
[input_signature.type.nested]
name = "integer"

[[input_signature]]
argument_name = "k"
[input_signature.type]
name = "integer"

[output_signature.type]
name = "integer"

[[asserts]]
arguments = [[1], 0]
comment   = "Single holiday"
expected  = 1

[[asserts]]
arguments = [[0], 0]
comment   = "Single workday, no replacements"
expected  = 0

[[asserts]]
arguments = [[0], 1]
comment   = "Replace single workday"
expected  = 1

[[asserts]]
arguments = [[1, 1], 0]
comment   = "Two consecutive holidays"
expected  = 2

[[asserts]]
arguments = [[0, 0], 1]
comment   = "Two workdays, replace one"
expected  = 1

[[asserts]]
arguments = [[0, 0], 2]
comment   = "Replace both workdays"
expected  = 2

[[asserts]]
arguments = [[1, 0, 1], 1]
comment   = "Connect two holidays"
expected  = 3

[[asserts]]
arguments = [[1, 0, 0, 1], 1]
comment   = "Best window has 1 zero: [1,0] or [0,1]"
expected  = 2

[[asserts]]
arguments = [[1, 0, 0, 1], 2]
comment   = "Replace both zeros"
expected  = 4

[[asserts]]
arguments = [[1, 1, 0, 0, 1, 1], 2]
comment   = "Full period with two replacements"
expected  = 6

[[asserts]]
arguments = [[0, 0, 0], 0]
comment   = "All workdays, no replacements"
expected  = 0

[[asserts]]
arguments = [[0, 0, 0], 1]
comment   = "Replace one of three"
expected  = 1

[[asserts]]
arguments = [[0, 0, 0], 2]
comment   = "Replace two of three"
expected  = 2

[[asserts]]
arguments = [[0, 0, 0], 3]
comment   = "Replace all three"
expected  = 3

[[asserts]]
arguments = [[1, 1, 1], 0]
comment   = "All holidays already"
expected  = 3

[[asserts]]
arguments = [[1, 0, 1, 0, 1], 2]
comment   = "Replace two gaps"
expected  = 5

[[asserts]]
arguments = [[1, 0, 1, 0, 1, 0], 2]
comment   = "Best window is five"
expected  = 5

[[asserts]]
arguments = [[0, 1, 1, 1, 0], 1]
comment   = "Best window: [0,1,1,1] with 1 zero"
expected  = 4

[[asserts]]
arguments = [[0, 0, 1, 1, 0, 0], 2]
comment   = "Best is middle with two zeros"
expected  = 4

[[asserts]]
arguments = [[1, 0, 0, 0, 1], 1]
comment   = "Can only extend by one"
expected  = 2

[[asserts]]
arguments = [[1, 0, 0, 0, 1], 2]
comment   = "Can extend by two"
expected  = 3

[[asserts]]
arguments = [[1, 0, 0, 0, 1], 3]
comment   = "Replace all zeros"
expected  = 5

[[asserts]]
arguments = [[1, 1, 1, 0, 0, 0, 1, 1, 1], 2]
comment   = "Best window: [1,1,1,0,0] or [0,0,1,1,1] with 2 zeros"
expected  = 5

[[asserts]]
arguments = [[0, 0, 0, 0, 0], 5]
comment   = "Replace all five"
expected  = 5

[[asserts]]
arguments = [[0, 0, 0, 0, 0], 3]
comment   = "Replace three of five"
expected  = 3

[[asserts]]
arguments = [[1, 0, 1, 1, 0, 1], 1]
comment   = "Best is middle section"
expected  = 4

[[asserts]]
arguments = [[1, 1, 0, 1, 1], 1]
comment   = "Replace one zero in middle"
expected  = 5

[[asserts]]
arguments = [[0, 1, 0, 1, 0], 2]
comment   = "Best window: [0,1,0,1] or [1,0,1,0] with 2 zeros"
expected  = 4

[[asserts]]
arguments = [[1, 1, 1, 1, 1], 0]
comment   = "All holidays, no replacements needed"
expected  = 5

[[asserts]]
arguments = [[0, 0, 1, 0, 0], 1]
comment   = "Best is extending the one"
expected  = 2
